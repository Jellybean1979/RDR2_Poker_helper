<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>RDR2 Poker Advisor</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet" />
<style>
/* =============================================
   RDR2 POKER ADVISOR â€” Frontier Saloon Theme
   ============================================= */
:root {
  --felt: #1a3a1a;
  --felt-light: #234d23;
  --felt-highlight: #2a5c2a;
  --wood: #3d1f0a;
  --wood-light: #5c300f;
  --gold: #c9913d;
  --gold-light: #e8b86d;
  --gold-dim: #7a5520;
  --cream: #f0e6c8;
  --cream-dark: #d4c49a;
  --cream-dim: #a89060;
  --red-card: #8b1a1a;
  --black-card: #1a1a2e;
  --ink: #1a1209;
  --ink-light: #2e2010;
  --parchment: #f5ead0;
  --parchment-dark: #e8d5a0;
  --sepia: #6b4c1e;
  --action-raise: #7a1f1f;
  --action-call: #1f4a1f;
  --action-fold: #1a1a1a;
  --action-check: #1a2f4a;
  --warn: #8b5e00;
  --border-ornate: #7a5520;
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

body {
  background: var(--wood);
  font-family: 'Crimson Text', Georgia, serif;
  min-height: 100vh;
  background-image:
    repeating-linear-gradient(
      90deg,
      transparent,
      transparent 40px,
      rgba(0,0,0,0.03) 40px,
      rgba(0,0,0,0.03) 41px
    ),
    repeating-linear-gradient(
      0deg,
      transparent,
      transparent 40px,
      rgba(0,0,0,0.03) 40px,
      rgba(0,0,0,0.03) 41px
    ),
    radial-gradient(ellipse at center, #4a2810 0%, #2a1205 100%);
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 20px 12px 40px;
}

/* â”€â”€ HEADER â”€â”€ */
header {
  text-align: center;
  margin-bottom: 24px;
  position: relative;
}
.header-ornament {
  color: var(--gold);
  font-size: 1.1rem;
  letter-spacing: 6px;
  opacity: 0.7;
  display: block;
  margin-bottom: 4px;
}
h1 {
  font-family: 'Playfair Display', serif;
  font-size: clamp(1.8rem, 5vw, 3rem);
  font-weight: 900;
  color: var(--gold-light);
  text-shadow:
    0 2px 4px rgba(0,0,0,0.8),
    0 0 30px rgba(201,145,61,0.3);
  letter-spacing: 2px;
  line-height: 1.1;
}
.subtitle {
  font-family: 'Crimson Text', serif;
  font-style: italic;
  color: var(--cream-dim);
  font-size: 1rem;
  margin-top: 6px;
  letter-spacing: 1px;
}
.header-rule {
  width: 280px;
  height: 1px;
  background: linear-gradient(90deg, transparent, var(--gold), transparent);
  margin: 10px auto 0;
}

/* â”€â”€ MAIN LAYOUT â”€â”€ */
.main-layout {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
  width: 100%;
  max-width: 960px;
}
@media (max-width: 720px) {
  .main-layout { grid-template-columns: 1fr; }
}

/* â”€â”€ PANEL â”€â”€ */
.panel {
  background: var(--parchment);
  border: 2px solid var(--border-ornate);
  border-radius: 4px;
  padding: 20px;
  box-shadow:
    0 4px 20px rgba(0,0,0,0.6),
    inset 0 1px 0 rgba(255,255,255,0.15),
    inset 0 0 40px rgba(0,0,0,0.08);
  position: relative;
}
.panel::before, .panel::after {
  content: 'âœ¦';
  position: absolute;
  color: var(--gold-dim);
  font-size: 0.7rem;
}
.panel::before { top: 6px; left: 10px; }
.panel::after  { top: 6px; right: 10px; }

.panel-title {
  font-family: 'Playfair Display', serif;
  font-size: 1.1rem;
  font-weight: 700;
  color: var(--sepia);
  text-align: center;
  letter-spacing: 2px;
  text-transform: uppercase;
  margin-bottom: 16px;
  padding-bottom: 10px;
  border-bottom: 1px solid var(--cream-dark);
  position: relative;
}
.panel-title::after {
  content: '';
  display: block;
  width: 60px;
  height: 2px;
  background: var(--gold);
  margin: 6px auto 0;
  opacity: 0.6;
}

/* â”€â”€ FORM ELEMENTS â”€â”€ */
.field-group {
  margin-bottom: 14px;
}
label {
  display: block;
  font-size: 0.82rem;
  font-weight: 600;
  color: var(--sepia);
  text-transform: uppercase;
  letter-spacing: 1.5px;
  margin-bottom: 5px;
}
select, input[type="number"], input[type="text"] {
  width: 100%;
  background: var(--cream);
  border: 1px solid var(--cream-dark);
  border-bottom: 2px solid var(--border-ornate);
  border-radius: 2px;
  padding: 8px 10px;
  font-family: 'Crimson Text', serif;
  font-size: 1rem;
  color: var(--ink);
  outline: none;
  transition: border-color 0.2s, box-shadow 0.2s;
  appearance: none;
  -webkit-appearance: none;
}
select {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6'%3E%3Cpath d='M0 0l5 6 5-6z' fill='%236b4c1e'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 10px center;
  padding-right: 28px;
}
select:focus, input:focus {
  border-color: var(--gold);
  box-shadow: 0 0 0 2px rgba(201,145,61,0.2);
}
.field-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}

/* â”€â”€ CARD SELECTOR â”€â”€ */
.card-selector {
  display: flex;
  gap: 10px;
  margin-bottom: 14px;
}
.card-slot {
  flex: 1;
}
.card-slot label {
  text-align: center;
}
.card-display {
  background: white;
  border: 2px solid #ccc;
  border-radius: 6px;
  height: 64px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.3rem;
  font-weight: 700;
  cursor: pointer;
  transition: border-color 0.2s, transform 0.15s, box-shadow 0.2s;
  position: relative;
  box-shadow: 0 2px 6px rgba(0,0,0,0.15);
  user-select: none;
}
.card-display:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.25);
}
.card-display.hearts, .card-display.diamonds { color: var(--red-card); border-color: #e88; }
.card-display.spades, .card-display.clubs    { color: var(--black-card); border-color: #88a; }
.card-display.selected { border-color: var(--gold); box-shadow: 0 0 0 3px rgba(201,145,61,0.35); }
.card-display.empty { color: #aaa; font-size: 2rem; border-style: dashed; }

/* Card picker modal */
.picker-overlay {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.7);
  z-index: 100;
  align-items: center;
  justify-content: center;
}
.picker-overlay.open { display: flex; }
.picker-box {
  background: var(--parchment);
  border: 2px solid var(--border-ornate);
  border-radius: 6px;
  padding: 20px;
  max-width: 400px;
  width: 94%;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 10px 60px rgba(0,0,0,0.8);
}
.picker-title {
  font-family: 'Playfair Display', serif;
  font-weight: 700;
  font-size: 1.1rem;
  color: var(--sepia);
  text-align: center;
  margin-bottom: 14px;
  letter-spacing: 2px;
  text-transform: uppercase;
}
.picker-suits {
  display: flex;
  gap: 8px;
  margin-bottom: 12px;
  justify-content: center;
}
.suit-btn {
  background: white;
  border: 2px solid #ddd;
  border-radius: 4px;
  padding: 6px 14px;
  font-size: 1.3rem;
  cursor: pointer;
  transition: border-color 0.15s, transform 0.1s;
}
.suit-btn:hover { transform: scale(1.1); }
.suit-btn.active { border-color: var(--gold); background: #fff8ee; }
.picker-ranks {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 6px;
}
.rank-btn {
  background: white;
  border: 2px solid #ddd;
  border-radius: 4px;
  padding: 8px 4px;
  font-family: 'Crimson Text', serif;
  font-size: 1rem;
  font-weight: 700;
  cursor: pointer;
  text-align: center;
  transition: background 0.1s, border-color 0.1s;
}
.rank-btn:hover { background: #fff0d0; border-color: var(--gold); }
.rank-btn.used { opacity: 0.3; pointer-events: none; background: #eee; }
.picker-cancel {
  display: block;
  margin: 14px auto 0;
  background: transparent;
  border: 1px solid var(--sepia);
  border-radius: 3px;
  padding: 6px 20px;
  font-family: 'Crimson Text', serif;
  font-size: 0.9rem;
  color: var(--sepia);
  cursor: pointer;
  letter-spacing: 1px;
}
.picker-cancel:hover { background: rgba(107,76,30,0.1); }

/* â”€â”€ COMMUNITY CARDS â”€â”€ */
.community-row {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  justify-content: center;
  margin-bottom: 10px;
}
.community-card {
  background: white;
  border: 2px solid #ccc;
  border-radius: 5px;
  width: 48px;
  height: 64px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  font-size: 0.95rem;
  font-weight: 700;
  cursor: pointer;
  transition: border-color 0.15s, transform 0.1s, box-shadow 0.15s;
  box-shadow: 0 2px 5px rgba(0,0,0,0.12);
}
.community-card:hover { transform: translateY(-2px); }
.community-card.hearts, .community-card.diamonds { color: var(--red-card); border-color: #e88; }
.community-card.spades, .community-card.clubs    { color: var(--black-card); }
.community-card.empty   { color: #bbb; font-size: 1.4rem; border-style: dashed; }
.community-card.locked  { opacity: 0.4; cursor: not-allowed; }
.community-card.selected { border-color: var(--gold); box-shadow: 0 0 0 3px rgba(201,145,61,0.35); }
.card-label {
  font-family: 'Crimson Text', serif;
  font-size: 0.58rem;
  color: #888;
  letter-spacing: 0.5px;
  text-transform: uppercase;
  margin-top: 3px;
}

/* â”€â”€ BUTTONS â”€â”€ */
.btn-primary {
  display: block;
  width: 100%;
  background: linear-gradient(135deg, #3d1505, #6b2a0a);
  border: 1px solid var(--gold-dim);
  border-radius: 3px;
  padding: 12px;
  font-family: 'Playfair Display', serif;
  font-size: 1.05rem;
  font-weight: 700;
  color: var(--gold-light);
  letter-spacing: 2px;
  text-transform: uppercase;
  cursor: pointer;
  transition: background 0.2s, box-shadow 0.2s, transform 0.1s;
  box-shadow: 0 3px 10px rgba(0,0,0,0.4);
}
.btn-primary:hover {
  background: linear-gradient(135deg, #5a2008, #8b3810);
  box-shadow: 0 5px 16px rgba(0,0,0,0.5);
  transform: translateY(-1px);
}
.btn-primary:active { transform: translateY(0); }

.btn-secondary {
  display: block;
  width: 100%;
  background: transparent;
  border: 1px solid var(--border-ornate);
  border-radius: 3px;
  padding: 9px;
  font-family: 'Crimson Text', serif;
  font-size: 0.95rem;
  font-weight: 600;
  color: var(--sepia);
  letter-spacing: 1px;
  text-transform: uppercase;
  cursor: pointer;
  margin-top: 10px;
  transition: background 0.2s;
}
.btn-secondary:hover { background: rgba(107,76,30,0.1); }

/* â”€â”€ ADVISOR PANEL (right column, full height) â”€â”€ */
.advisor-panel {
  grid-column: 2;
  grid-row: 1 / span 2;
  display: flex;
  flex-direction: column;
  gap: 16px;
}
@media (max-width: 720px) {
  .advisor-panel { grid-column: 1; grid-row: auto; }
}

/* â”€â”€ ADVICE BOX â”€â”€ */
.advice-box {
  background: var(--felt);
  border: 2px solid var(--felt-highlight);
  border-radius: 4px;
  padding: 20px;
  box-shadow: inset 0 0 40px rgba(0,0,0,0.4), 0 4px 20px rgba(0,0,0,0.5);
  flex: 1;
  min-height: 300px;
  display: flex;
  flex-direction: column;
}
.advice-header {
  font-family: 'Playfair Display', serif;
  font-size: 0.85rem;
  font-weight: 700;
  color: var(--gold-dim);
  text-transform: uppercase;
  letter-spacing: 3px;
  margin-bottom: 14px;
  text-align: center;
}
.advice-action {
  text-align: center;
  margin-bottom: 16px;
}
.action-badge {
  display: inline-block;
  font-family: 'Playfair Display', serif;
  font-size: 1.7rem;
  font-weight: 900;
  letter-spacing: 3px;
  text-transform: uppercase;
  padding: 10px 28px;
  border-radius: 3px;
  border: 2px solid currentColor;
  box-shadow: 0 0 20px rgba(0,0,0,0.5);
}
.action-badge.RAISE  { color: #f87171; border-color: #f87171; text-shadow: 0 0 12px rgba(248,113,113,0.5); }
.action-badge.CALL   { color: #86efac; border-color: #86efac; text-shadow: 0 0 12px rgba(134,239,172,0.4); }
.action-badge.CHECK  { color: #93c5fd; border-color: #93c5fd; text-shadow: 0 0 12px rgba(147,197,253,0.4); }
.action-badge.FOLD   { color: #d1d5db; border-color: #d1d5db; }
.action-badge.WAIT   { color: var(--gold); border-color: var(--gold-dim); font-size: 1rem; padding: 14px 20px; }

.advice-amount {
  font-family: 'Crimson Text', serif;
  font-size: 1rem;
  color: var(--cream-dim);
  text-align: center;
  margin-top: 6px;
  font-style: italic;
}

.advice-reasoning {
  background: rgba(0,0,0,0.2);
  border-left: 3px solid var(--gold-dim);
  border-radius: 0 3px 3px 0;
  padding: 12px 14px;
  margin-top: 4px;
  flex: 1;
}
.advice-reasoning p {
  font-family: 'Crimson Text', serif;
  font-size: 1rem;
  color: var(--cream);
  line-height: 1.65;
  margin-bottom: 8px;
}
.advice-reasoning p:last-child { margin-bottom: 0; }
.advice-reasoning strong { color: var(--gold-light); font-weight: 600; }

/* â”€â”€ HAND LOG â”€â”€ */
.hand-log {
  background: rgba(0,0,0,0.25);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 3px;
  padding: 12px;
  max-height: 180px;
  overflow-y: auto;
}
.hand-log::-webkit-scrollbar { width: 4px; }
.hand-log::-webkit-scrollbar-thumb { background: var(--gold-dim); border-radius: 2px; }
.log-title {
  font-family: 'Playfair Display', serif;
  font-size: 0.75rem;
  color: var(--gold-dim);
  text-transform: uppercase;
  letter-spacing: 2px;
  margin-bottom: 8px;
  text-align: center;
}
.log-entry {
  font-family: 'Crimson Text', serif;
  font-size: 0.88rem;
  color: var(--cream-dim);
  padding: 4px 0;
  border-bottom: 1px solid rgba(255,255,255,0.05);
  display: flex;
  gap: 8px;
  align-items: baseline;
}
.log-entry:last-child { border-bottom: none; }
.log-street {
  color: var(--gold);
  font-weight: 600;
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 1px;
  white-space: nowrap;
}
.log-action-text { color: var(--cream); }
.log-empty { color: rgba(255,255,255,0.25); font-style: italic; text-align: center; font-size: 0.9rem; padding: 8px 0; }

/* â”€â”€ STREET INDICATOR â”€â”€ */
.street-indicator {
  display: flex;
  gap: 6px;
  justify-content: center;
  margin-bottom: 14px;
}
.street-pip {
  width: 28px;
  height: 6px;
  border-radius: 3px;
  background: rgba(0,0,0,0.3);
  border: 1px solid rgba(255,255,255,0.1);
  transition: background 0.3s;
}
.street-pip.active   { background: var(--gold); box-shadow: 0 0 6px var(--gold); }
.street-pip.complete { background: var(--gold-dim); }

/* â”€â”€ POT / STATS â”€â”€ */
.stats-row {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 8px;
  margin-bottom: 14px;
}
.stat-box {
  background: rgba(0,0,0,0.2);
  border: 1px solid rgba(255,255,255,0.07);
  border-radius: 3px;
  padding: 8px;
  text-align: center;
}
.stat-label {
  font-size: 0.65rem;
  text-transform: uppercase;
  letter-spacing: 1.5px;
  color: var(--gold-dim);
  display: block;
  margin-bottom: 3px;
}
.stat-value {
  font-family: 'Playfair Display', serif;
  font-size: 1rem;
  font-weight: 700;
  color: var(--cream);
}

/* â”€â”€ HAND STRENGTH METER â”€â”€ */
.strength-bar-wrap {
  margin: 10px 0;
}
.strength-bar-label {
  display: flex;
  justify-content: space-between;
  font-size: 0.72rem;
  color: var(--gold-dim);
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: 4px;
}
.strength-bar-track {
  height: 8px;
  background: rgba(0,0,0,0.3);
  border-radius: 4px;
  overflow: hidden;
  border: 1px solid rgba(255,255,255,0.07);
}
.strength-bar-fill {
  height: 100%;
  border-radius: 4px;
  transition: width 0.5s ease, background 0.4s ease;
  background: linear-gradient(90deg, #4ade80, #fbbf24);
}

/* â”€â”€ RESPONSIVE TWEAKS â”€â”€ */
@media (max-width: 480px) {
  .picker-ranks { grid-template-columns: repeat(5, 1fr); }
  .stats-row { grid-template-columns: 1fr 1fr; }
}
</style>
</head>
<body>

<header>
  <span class="header-ornament">â™  â™¥ â™¦ â™£</span>
  <h1>RDR2 Poker Advisor</h1>
  <p class="subtitle">Texas Hold'em Strategy for the Frontier Saloon</p>
  <div class="header-rule"></div>
</header>

<div class="main-layout">

  <!-- LEFT COLUMN: Inputs -->
  <div style="display:flex;flex-direction:column;gap:20px;">

    <!-- Setup Panel -->
    <div class="panel">
      <div class="panel-title">Hand Setup</div>

      <div class="field-row">
        <div class="field-group">
          <label>Players at Table</label>
          <select id="numPlayers">
            <option value="2">2 Players</option>
            <option value="3">3 Players</option>
            <option value="4" selected>4 Players</option>
            <option value="5">5 Players</option>
            <option value="6">6 Players</option>
          </select>
        </div>
        <div class="field-group">
          <label>Your Position</label>
          <select id="position">
            <option value="BTN">BTN (Button)</option>
            <option value="CO">CO (Cutoff)</option>
            <option value="MP">MP (Mid Position)</option>
            <option value="UTG">UTG (Under the Gun)</option>
            <option value="SB">SB (Small Blind)</option>
            <option value="BB">BB (Big Blind)</option>
          </select>
        </div>
      </div>

      <div class="field-row">
        <div class="field-group">
          <label>Current Pot ($)</label>
          <input type="number" id="potSize" placeholder="e.g. 1.34" step="0.01" min="0" value="" />
        </div>
        <div class="field-group">
          <label>Amount to Call ($)</label>
          <input type="number" id="callAmount" placeholder="0 = no bet" step="0.01" min="0" value="0" />
        </div>
      </div>

      <div class="field-group">
        <label>Street</label>
        <select id="street" onchange="onStreetChange()">
          <option value="preflop">Preflop</option>
          <option value="flop">Flop</option>
          <option value="turn">Turn</option>
          <option value="river">River</option>
        </select>
      </div>

      <!-- Hole Cards -->
      <div class="field-group">
        <label>Your Hole Cards</label>
        <div class="card-selector">
          <div class="card-slot">
            <div class="card-display empty" id="holeCard1Display" onclick="openPicker('hole1')">+</div>
          </div>
          <div class="card-slot">
            <div class="card-display empty" id="holeCard2Display" onclick="openPicker('hole2')">+</div>
          </div>
        </div>
      </div>

      <button class="btn-primary" onclick="getAdvice()">Get Advice</button>
      <button class="btn-secondary" onclick="resetHand()">âœ• Reset Hand</button>
    </div>

    <!-- Community Cards Panel -->
    <div class="panel" id="communityPanel">
      <div class="panel-title">Community Cards</div>
      <p style="font-size:0.85rem;color:var(--sepia);text-align:center;margin-bottom:12px;font-style:italic;">
        Click a card slot to set it. Cards unlock as the street advances.
      </p>
      <div class="community-row">
        <div style="text-align:center">
          <div class="community-card empty" id="cc0" onclick="openPicker('cc0')">+<div class="card-label">Flop 1</div></div>
        </div>
        <div style="text-align:center">
          <div class="community-card empty" id="cc1" onclick="openPicker('cc1')">+<div class="card-label">Flop 2</div></div>
        </div>
        <div style="text-align:center">
          <div class="community-card empty" id="cc2" onclick="openPicker('cc2')">+<div class="card-label">Flop 3</div></div>
        </div>
        <div style="text-align:center">
          <div class="community-card empty locked" id="cc3">+<div class="card-label">Turn</div></div>
        </div>
        <div style="text-align:center">
          <div class="community-card empty locked" id="cc4">+<div class="card-label">River</div></div>
        </div>
      </div>
    </div>

  </div><!-- end left column -->

  <!-- RIGHT COLUMN: Advisor -->
  <div class="advisor-panel">

    <div class="advice-box">
      <div class="advice-header">âš‘ Advisor</div>

      <div class="street-indicator">
        <div class="street-pip active" id="pip-preflop" title="Preflop"></div>
        <div class="street-pip" id="pip-flop" title="Flop"></div>
        <div class="street-pip" id="pip-turn" title="Turn"></div>
        <div class="street-pip" id="pip-river" title="River"></div>
      </div>

      <div class="stats-row" id="statsRow">
        <div class="stat-box">
          <span class="stat-label">Pot</span>
          <span class="stat-value" id="statPot">â€”</span>
        </div>
        <div class="stat-box">
          <span class="stat-label">Pot Odds</span>
          <span class="stat-value" id="statOdds">â€”</span>
        </div>
        <div class="stat-box">
          <span class="stat-label">Hand Str.</span>
          <span class="stat-value" id="statStr">â€”</span>
        </div>
      </div>

      <div class="strength-bar-wrap">
        <div class="strength-bar-label">
          <span>Weak</span>
          <span id="strengthLabel">Hand Strength</span>
          <span>Strong</span>
        </div>
        <div class="strength-bar-track">
          <div class="strength-bar-fill" id="strengthBar" style="width:0%"></div>
        </div>
      </div>

      <div class="advice-action">
        <span class="action-badge WAIT" id="actionBadge">Enter your hand</span>
      </div>
      <div class="advice-amount" id="adviceAmount"></div>

      <div class="advice-reasoning" id="adviceReasoning">
        <p>Fill in your hand details on the left and press <strong>Get Advice</strong> to receive frontier wisdom.</p>
        <p>The advisor accounts for <strong>RDR2's AI tendencies</strong>: loose calls, passive play, rare bluffs, and a love of top pair.</p>
      </div>
    </div>

    <!-- Hand Log -->
    <div class="advice-box" style="min-height:0;flex:none;padding:16px;">
      <div class="hand-log">
        <div class="log-title">Hand History</div>
        <div id="logEntries"><div class="log-empty">No actions yet this hand.</div></div>
      </div>
    </div>

  </div><!-- end right column -->

</div><!-- end main layout -->

<!-- Card Picker Modal -->
<div class="picker-overlay" id="pickerOverlay">
  <div class="picker-box">
    <div class="picker-title" id="pickerTitle">Select a Card</div>
    <div class="picker-suits" id="pickerSuits">
      <button class="suit-btn active" data-suit="hearts"   onclick="selectSuit('hearts')">â™¥</button>
      <button class="suit-btn"        data-suit="diamonds" onclick="selectSuit('diamonds')">â™¦</button>
      <button class="suit-btn"        data-suit="clubs"    onclick="selectSuit('clubs')">â™£</button>
      <button class="suit-btn"        data-suit="spades"   onclick="selectSuit('spades')">â™ </button>
    </div>
    <div class="picker-ranks" id="pickerRanks"></div>
    <button class="picker-cancel" onclick="closePicker()">Cancel</button>
  </div>
</div>

<script>
// =============================================
// RDR2 POKER ADVISOR â€” LOGIC
// =============================================

// â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const state = {
  holeCards: [null, null],
  communityCards: [null, null, null, null, null], // cc0..cc4
  handLog: [],
};

let pickerTarget = null;
let pickerSuit   = 'hearts';

const RANKS = ['2','3','4','5','6','7','8','9','10','J','Q','K','A'];
const RANK_VAL = {'2':2,'3':3,'4':4,'5':5,'6':6,'7':7,'8':8,'9':9,'10':10,'J':11,'Q':12,'K':13,'A':14};
const SUIT_SYMBOL = { hearts:'â™¥', diamonds:'â™¦', clubs:'â™£', spades:'â™ ' };

// â”€â”€ STREET MANAGEMENT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function onStreetChange() {
  const street = document.getElementById('street').value;
  updateCommunityLocks(street);
  updateStreetPips(street);
}

function updateCommunityLocks(street) {
  const unlocked = { preflop:[],  flop:[0,1,2], turn:[0,1,2,3], river:[0,1,2,3,4] };
  const allowed = unlocked[street] || [];
  for (let i = 0; i < 5; i++) {
    const el = document.getElementById(`cc${i}`);
    if (allowed.includes(i)) {
      el.classList.remove('locked');
      el.style.cursor = 'pointer';
      el.onclick = () => openPicker(`cc${i}`);
    } else {
      el.classList.add('locked');
      el.style.cursor = 'not-allowed';
      el.onclick = null;
    }
  }
}

function updateStreetPips(street) {
  const streets = ['preflop','flop','turn','river'];
  const idx = streets.indexOf(street);
  streets.forEach((s, i) => {
    const pip = document.getElementById(`pip-${s}`);
    pip.classList.toggle('active', i === idx);
    pip.classList.toggle('complete', i < idx);
  });
}

// â”€â”€ CARD PICKER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openPicker(target) {
  pickerTarget = target;
  pickerSuit   = 'hearts';
  document.getElementById('pickerTitle').textContent =
    target.startsWith('cc') ? 'Select Community Card' : 'Select Hole Card';
  document.getElementById('pickerOverlay').classList.add('open');
  renderSuits();
  renderRanks();
}

function closePicker() {
  document.getElementById('pickerOverlay').classList.remove('open');
  pickerTarget = null;
}

function selectSuit(suit) {
  pickerSuit = suit;
  renderSuits();
  renderRanks();
}

function renderSuits() {
  document.querySelectorAll('.suit-btn').forEach(btn => {
    btn.classList.toggle('active', btn.dataset.suit === pickerSuit);
  });
}

function usedCards() {
  const used = [];
  state.holeCards.forEach(c => { if (c) used.push(c.rank + c.suit); });
  state.communityCards.forEach(c => { if (c) used.push(c.rank + c.suit); });
  return used;
}

function renderRanks() {
  const container = document.getElementById('pickerRanks');
  const used = usedCards();
  // Exclude the currently targeted card from "used"
  const currentCard = getCardForTarget(pickerTarget);
  const currentKey  = currentCard ? currentCard.rank + currentCard.suit : null;

  container.innerHTML = '';
  RANKS.forEach(rank => {
    const key = rank + pickerSuit;
    const btn = document.createElement('button');
    btn.className = 'rank-btn' + (used.includes(key) && key !== currentKey ? ' used' : '');
    btn.textContent = rank;
    if (pickerSuit === 'hearts' || pickerSuit === 'diamonds') btn.style.color = '#8b1a1a';
    btn.onclick = () => pickCard(rank, pickerSuit);
    container.appendChild(btn);
  });
}

function getCardForTarget(target) {
  if (!target) return null;
  if (target === 'hole1') return state.holeCards[0];
  if (target === 'hole2') return state.holeCards[1];
  const idx = parseInt(target.replace('cc',''));
  return state.communityCards[idx];
}

function pickCard(rank, suit) {
  const card = { rank, suit };
  if (pickerTarget === 'hole1') {
    state.holeCards[0] = card;
    renderHoleCard('holeCard1Display', card);
  } else if (pickerTarget === 'hole2') {
    state.holeCards[1] = card;
    renderHoleCard('holeCard2Display', card);
  } else if (pickerTarget && pickerTarget.startsWith('cc')) {
    const idx = parseInt(pickerTarget.replace('cc',''));
    state.communityCards[idx] = card;
    renderCommunityCard(idx, card);
  }
  closePicker();
}

function renderHoleCard(elId, card) {
  const el = document.getElementById(elId);
  el.className = `card-display ${card.suit} selected`;
  el.innerHTML = `<span style="font-size:1.6rem">${SUIT_SYMBOL[card.suit]}</span><span style="font-size:1rem;font-weight:700">${card.rank}</span>`;
  el.onclick = () => openPicker(elId === 'holeCard1Display' ? 'hole1' : 'hole2');
}

function renderCommunityCard(idx, card) {
  const el = document.getElementById(`cc${idx}`);
  const labels = ['Flop 1','Flop 2','Flop 3','Turn','River'];
  el.className = `community-card ${card.suit} selected`;
  el.innerHTML = `${SUIT_SYMBOL[card.suit]}<span style="font-size:0.85rem;font-weight:700;display:block">${card.rank}</span><div class="card-label">${labels[idx]}</div>`;
}

// â”€â”€ HAND EVALUATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function cardVal(card) { return RANK_VAL[card.rank]; }

function evaluateHand(hole, community) {
  // Returns { rank: 0-9, name, strength: 0-100 }
  const all = [...hole, ...community].filter(Boolean);
  if (all.length < 2) return { rank: 0, name: 'Unknown', strength: 0 };

  const combos = getCombinations(all, Math.min(all.length, 5));
  let best = { rank: -1, name: '', strength: 0 };
  combos.forEach(combo => {
    const result = scoreHand(combo);
    if (result.rank > best.rank || (result.rank === best.rank && result.tiebreak > (best.tiebreak||0))) {
      best = result;
    }
  });
  return best;
}

function getCombinations(arr, k) {
  if (k === arr.length) return [arr];
  if (k === 1) return arr.map(x => [x]);
  const result = [];
  for (let i = 0; i <= arr.length - k; i++) {
    const rest = getCombinations(arr.slice(i+1), k-1);
    rest.forEach(combo => result.push([arr[i], ...combo]));
  }
  return result;
}

function scoreHand(cards) {
  const vals   = cards.map(c => cardVal(c)).sort((a,b) => b-a);
  const suits  = cards.map(c => c.suit);
  const ranks  = cards.map(c => c.rank);

  const isFlush     = cards.length === 5 && suits.every(s => s === suits[0]);
  const isStraight  = cards.length === 5 && checkStraight(vals);
  const isRoyal     = isFlush && isStraight && vals[0] === 14;
  const counts      = countOccurrences(vals);
  const countVals   = Object.values(counts).sort((a,b) => b-a);

  if (isRoyal)                                    return { rank:9, name:'Royal Flush',     strength:100, tiebreak:vals[0] };
  if (isFlush && isStraight)                      return { rank:8, name:'Straight Flush',  strength:95,  tiebreak:vals[0] };
  if (countVals[0] === 4)                         return { rank:7, name:'Four of a Kind',  strength:88,  tiebreak:vals[0] };
  if (countVals[0] === 3 && countVals[1] === 2)   return { rank:6, name:'Full House',      strength:80,  tiebreak:vals[0] };
  if (isFlush)                                    return { rank:5, name:'Flush',           strength:72,  tiebreak:vals[0] };
  if (isStraight)                                 return { rank:4, name:'Straight',        strength:64,  tiebreak:vals[0] };
  if (countVals[0] === 3)                         return { rank:3, name:'Three of a Kind', strength:55,  tiebreak:vals[0] };
  if (countVals[0] === 2 && countVals[1] === 2)   return { rank:2, name:'Two Pair',        strength:42,  tiebreak:vals[0] };
  if (countVals[0] === 2)                         return { rank:1, name:'Pair',            strength:28,  tiebreak:vals[0] };
  return                                                 { rank:0, name:'High Card',       strength:Math.round((vals[0]/14)*20), tiebreak:vals[0] };
}

function checkStraight(sortedVals) {
  for (let i = 0; i < sortedVals.length-1; i++) {
    if (sortedVals[i] - sortedVals[i+1] !== 1) {
      // Check A-2-3-4-5 wheel
      if (i === 0 && sortedVals[0] === 14) {
        const low = sortedVals.slice(1);
        return low[0]===5 && low[1]===4 && low[2]===3 && low[3]===2;
      }
      return false;
    }
  }
  return true;
}

function countOccurrences(arr) {
  return arr.reduce((acc, v) => { acc[v] = (acc[v]||0)+1; return acc; }, {});
}

// â”€â”€ PREFLOP HAND CATEGORY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function preflopHandRank(hole) {
  if (!hole[0] || !hole[1]) return { tier: 0, desc: 'Unknown' };
  const [a, b] = [hole[0], hole[1]].sort((x,y) => cardVal(y) - cardVal(x));
  const av = cardVal(a), bv = cardVal(b);
  const suited   = a.suit === b.suit;
  const paired   = av === bv;
  const gap      = av - bv;

  if (paired) {
    if (av >= 10) return { tier: 5, desc: 'Premium Pair (TT+)' };
    if (av >= 7)  return { tier: 4, desc: 'Mid Pair (77-99)' };
    return              { tier: 3, desc: 'Low Pair (22-66)' };
  }
  if (av === 14 && bv >= 10) return { tier: 5, desc: 'Big Ace (AJ+)' };
  if (av === 14 && bv >= 7)  return { tier: 4, desc: 'Medium Ace' };
  if (av === 14)             return { tier: 3, desc: 'Small Ace' };
  if (av >= 10 && bv >= 10)  return { tier: 5, desc: 'Big Broadways (KQ, KJ, QJ)' };
  if (av >= 10 && gap <= 1 && suited) return { tier: 4, desc: 'Suited Connectors (High)' };
  if (gap <= 1 && suited)    return { tier: 3, desc: 'Suited Connectors' };
  if (av >= 10 && bv >= 8)   return { tier: 3, desc: 'Offsuit Broadway' };
  if (gap <= 1)              return { tier: 2, desc: 'Off-suit Connectors' };
  return                          { tier: 1, desc: 'Weak Hand' };
}

// â”€â”€ DRAW DETECTION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function detectDraws(hole, community) {
  const draws = [];
  const all = [...hole, ...community].filter(Boolean);
  if (all.length < 3) return draws;

  // Flush draw
  const suitCounts = {};
  all.forEach(c => suitCounts[c.suit] = (suitCounts[c.suit]||0)+1);
  if (Object.values(suitCounts).some(v => v === 4)) draws.push('Flush Draw');
  if (Object.values(suitCounts).some(v => v >= 3 && hole.some(h => h && h.suit === Object.keys(suitCounts).find(s => suitCounts[s] === v)))) {}

  // Straight draw
  const vals = [...new Set(all.map(c => cardVal(c)))].sort((a,b)=>a-b);
  for (let i = 0; i < vals.length - 3; i++) {
    const slice = vals.slice(i, i+4);
    if (slice[3] - slice[0] <= 4 && new Set(slice).size === 4) {
      draws.push('Straight Draw');
      break;
    }
  }
  return draws;
}

// â”€â”€ POT ODDS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function calcPotOdds(pot, call) {
  if (!call || call <= 0) return null;
  return (call / (pot + call) * 100).toFixed(0);
}

// â”€â”€ POSITION BONUS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function positionScore(pos) {
  return { BTN:5, CO:4, MP:2, UTG:1, SB:2, BB:1 }[pos] || 1;
}

// â”€â”€ RDR2 AI PROFILE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// RDR2 NPCs: loose-passive, call too wide, almost never bluff on river,
// over-value top pair, slow-play less than real players, rare 3-bets.
function getRDR2Advice(params) {
  const { street, position, numPlayers, pot, call, hole, community } = params;
  const posScore = positionScore(position);
  const potOdds  = calcPotOdds(pot, call);
  const draws    = detectDraws(hole, community);
  const hasDraw  = draws.length > 0;

  // â”€â”€ PREFLOP â”€â”€
  if (street === 'preflop') {
    const { tier, desc } = preflopHandRank(hole);
    const suited = hole[0] && hole[1] && hole[0].suit === hole[1].suit;

    let action, amount, reasoning, strength;

    if (tier === 5) {
      // Premium â€” always raise
      action = 'RAISE';
      const raiseAmt = (pot * 3).toFixed(2);
      amount = `Raise to ~$${raiseAmt} (3x pot)`;
      strength = 85 + posScore;
      reasoning = [
        `<strong>${desc}</strong> is a premium hand. In RDR2, the AI calls raises frequently preflop â€” punish them by raising 3x the pot.`,
        `From <strong>${position}</strong>, you have ${posScore >= 4 ? 'excellent late' : 'acceptable'} position. Build the pot now while you're ahead.`,
        `RDR2 opponents rarely 3-bet, so expect flat calls. You'll be in a strong spot heading to the flop.`
      ];
    } else if (tier === 4) {
      if (call > 0 && potOdds > 35) {
        action = 'CALL';
        amount = `Call $${call.toFixed(2)}`;
        strength = 60;
        reasoning = [
          `<strong>${desc}</strong> is solid but pot odds of ${potOdds}% are tight. The AI in RDR2 can wake up with strong hands here.`,
          `A flat call keeps the pot manageable${suited ? ' â€” your flush equity adds value.' : '.'}`,
        ];
      } else {
        action = 'RAISE';
        const raiseAmt = call > 0 ? (call*2.5).toFixed(2) : (pot*2.5).toFixed(2);
        amount = `Raise to ~$${raiseAmt}`;
        strength = 70;
        reasoning = [
          `<strong>${desc}</strong> plays best with initiative. RDR2 AI folds weaker hands to a raise${posScore >= 3 ? ' and your position is strong' : ''}.`,
          `With ${numPlayers} players, a raise narrows the field to hands you dominate.`
        ];
      }
    } else if (tier === 3) {
      if (call === 0) {
        action = posScore >= 3 ? 'RAISE' : 'CHECK';
        amount = posScore >= 3 ? `Raise to ~$${(pot*2).toFixed(2)} (2x pot)` : 'Check / Limp';
        strength = 45;
        reasoning = [
          `<strong>${desc}</strong> is playable from ${position}. ${posScore >= 3 ? 'In late position with no bet in front, a small raise builds the pot and gives you initiative.' : 'Check or limp to see a cheap flop.'}`,
          `RDR2 AI limps often preflop â€” if you raise from late position they'll often fold or just call.`
        ];
      } else if (potOdds < 25) {
        action = 'CALL';
        amount = `Call $${call.toFixed(2)}`;
        strength = 38;
        reasoning = [
          `Pot odds of ${potOdds}% are good enough for <strong>${desc}</strong>. RDR2 AI rarely bluffs preflop so the bet is usually real â€” but you have equity.`,
          `Play cautiously post-flop unless you improve.`
        ];
      } else {
        action = 'FOLD';
        amount = '';
        strength = 20;
        reasoning = [
          `At ${potOdds}% pot odds with <strong>${desc}</strong>, the math doesn't support continuing.`,
          `RDR2 AI that bets here likely has a strong hand. Save your money.`
        ];
      }
    } else if (tier === 2) {
      action = call > 0 ? 'FOLD' : 'CHECK';
      amount = '';
      strength = 18;
      reasoning = [
        `<strong>${desc}</strong> doesn't have the raw strength to profitably continue against a bet.`,
        `RDR2 AI doesn't bluff enough preflop to make this a profitable call. Fold or check to see a free flop.`
      ];
    } else {
      action = call > 0 ? 'FOLD' : 'CHECK';
      amount = '';
      strength = 8;
      reasoning = [
        `<strong>${desc}</strong> should be folded to any significant action.`,
        `In RDR2, even weak AI hands will outdraw you often enough that this isn't worth the chips.`
      ];
    }

    return { action, amount, reasoning, strength: Math.min(100, strength), draws: [] };
  }

  // â”€â”€ POST-FLOP (flop, turn, river) â”€â”€
  const handResult = evaluateHand(hole, community);
  const { rank, name: handName, strength: rawStrength } = handResult;
  let strength = rawStrength;
  let action, amount, reasoning;

  // Pot odds check
  const potOddsNum = potOdds ? parseInt(potOdds) : 0;

  // Adjust for draws
  if (hasDraw && rank < 2) {
    strength += draws.includes('Flush Draw') ? 20 : 12;
    strength = Math.min(strength, 60);
  }

  // Adjust for position
  strength += posScore * 2;

  // Street factor â€” hand strength means more on the river
  const riverFactor = { preflop:0.7, flop:0.85, turn:0.95, river:1.0 }[street] || 1;
  strength = Math.round(strength * riverFactor);
  strength = Math.min(100, Math.max(0, strength));

  // â”€â”€ RDR2 AI awareness â”€â”€
  // On river: AI RARELY bluffs. If there's a big bet on river, lean toward believing it.
  // AI calls with top pair very often (over-values it).
  // AI is prone to calling down with strong draws even if they don't hit.

  if (rank >= 6) {
    // Monster hand â€” extract value
    if (call > 0) {
      action = 'RAISE';
      const raiseAmt = (call * 2.5 + pot * 0.5).toFixed(2);
      amount = `Raise to ~$${raiseAmt}`;
    } else {
      action = street === 'river' ? 'RAISE' : 'RAISE';
      amount = `Bet ~$${(pot * 0.75).toFixed(2)} (3/4 pot)`;
    }
    reasoning = [
      `<strong>${handName}</strong> is an extremely strong hand. In RDR2, AI opponents over-value top pair and two pair â€” they will call you down.`,
      `${street === 'river' ? 'On the river, extract maximum value. AI almost never bluffs river, so a reraise here is safe.' : 'Build the pot now. The AI will follow you to the river with worse hands.'}`,
      `From <strong>${position}</strong>, you control the action. Keep the pressure on.`
    ];
  } else if (rank === 5) {
    // Flush
    action = call > 0 && potOddsNum < 40 ? 'CALL' : (call > 0 ? 'RAISE' : 'RAISE');
    amount = call > 0 ? `Raise to ~$${(call*2.2).toFixed(2)}` : `Bet ~$${(pot*0.65).toFixed(2)}`;
    reasoning = [
      `A <strong>Flush</strong> is a powerful hand in RDR2 â€” AI rarely folds when they hit any piece of the board, which means you'll get paid.`,
      `${street === 'river' ? 'On the river, make a strong value bet. AI river calls are very common.' : 'Don\'t slow-play. Put in a solid bet.'}`,
    ];
  } else if (rank === 4) {
    // Straight â€” be cautious of flush boards
    const communitySet = community.filter(Boolean);
    const suitCounts = {};
    communitySet.forEach(c => suitCounts[c.suit] = (suitCounts[c.suit]||0)+1);
    const flushBoard = Object.values(suitCounts).some(v => v >= 3);
    action = call > 0 && flushBoard ? 'CALL' : (call > 0 ? 'RAISE' : 'RAISE');
    amount = call > 0 && flushBoard ? `Call $${call.toFixed(2)}` : (call > 0 ? `Raise to ~$${(call*2).toFixed(2)}` : `Bet ~$${(pot*0.6).toFixed(2)}`);
    reasoning = [
      `A <strong>Straight</strong> is a strong hand. ${flushBoard ? 'âš ï¸ The board has a flush possibility â€” an AI raising here might have it.' : 'No flush board â€” you\'re in great shape.'}`,
      `RDR2 AI will call a straight with two pair or a set, thinking they're ahead. Bet for value.`
    ];
  } else if (rank === 3) {
    // Three of a kind
    action = call > 0 && potOddsNum > 45 ? 'CALL' : 'RAISE';
    amount = call > 0 ? `Raise to ~$${(Math.max(call,pot)*0.8).toFixed(2)}` : `Bet ~$${(pot*0.55).toFixed(2)}`;
    reasoning = [
      `<strong>Three of a Kind</strong> is a strong hand in RDR2. AI players will call this down with pairs and two pairs.`,
      `Bet with confidence${posScore >= 3 ? ' â€” your position lets you size up.' : '.'}`
    ];
  } else if (rank === 2) {
    // Two pair
    action = call === 0 ? 'RAISE' : (potOddsNum < 35 ? 'CALL' : (potOddsNum < 50 ? 'CALL' : 'FOLD'));
    const raiseAmt = (pot * 0.5).toFixed(2);
    amount = action === 'RAISE' ? `Bet ~$${raiseAmt} (half pot)` : (action === 'CALL' ? `Call $${call.toFixed(2)}` : '');
    reasoning = [
      `<strong>Two Pair</strong> is a good hand in RDR2, where AI players over-value single pairs.`,
      call > 0
        ? `Pot odds are ${potOdds}%. ${potOddsNum < 35 ? 'Good value to call, but be wary of raises behind.' : potOddsNum < 50 ? 'Borderline â€” calling is fine.' : 'Tough spot. Two pair loses to better two pairs, sets, and straights.'}`
        : `Bet to build the pot. AI will call with top pair thinking they\'re good.`,
      street === 'river' && call > 0 && potOddsNum > 45
        ? `âš ï¸ On the river, RDR2 AI almost never bluffs. A big bet here may mean they have a stronger hand. Fold is an option.`
        : ''
    ].filter(Boolean);
  } else if (rank === 1) {
    // One pair
    const isTopPair = community.filter(Boolean).length > 0 &&
      community.filter(Boolean).some(c => cardVal(c) <= Math.max(cardVal(hole[0]||{rank:'2'}), cardVal(hole[1]||{rank:'2'})));

    if (call === 0) {
      action = hasDraw ? 'RAISE' : 'CHECK';
      amount = hasDraw ? `Bet ~$${(pot*0.4).toFixed(2)} (semi-bluff)` : '';
      reasoning = [
        `<strong>Pair</strong> ${isTopPair ? '(Top Pair)' : ''} â€” ${hasDraw ? 'You have a draw to go with your pair. A semi-bluff bet has two ways to win.' : 'Check to control the pot. You don\'t want to bloat the pot with only a pair.'}`,
        `RDR2 AI checks back marginal hands frequently â€” a check may give you a free card.`
      ];
    } else {
      const callPct = potOddsNum;
      if (callPct < 25) {
        action = 'CALL';
        amount = `Call $${call.toFixed(2)}`;
        reasoning = [
          `<strong>Pair</strong> at ${callPct}% pot odds is worth calling. RDR2 AI bets weakly with drawing hands often.`,
          `Keep the pot small â€” don't re-raise here.`
        ];
      } else if (callPct < 40 && hasDraw) {
        action = 'CALL';
        amount = `Call $${call.toFixed(2)}`;
        reasoning = [
          `Pair + <strong>${draws.join(', ')}</strong> gives you enough outs to justify calling at ${callPct}% pot odds.`,
          `If you miss your draw on the next street, reconsider. RDR2 AI bets harder when they hit.`
        ];
      } else if (street === 'river') {
        action = 'FOLD';
        amount = '';
        reasoning = [
          `<strong>One Pair</strong> on the river facing a bet is dangerous in RDR2. AI players almost never bluff the river.`,
          `If the bet is more than a third of the pot, the AI likely has two pair or better. Fold is correct here.`
        ];
      } else {
        action = callPct < 40 ? 'CALL' : 'FOLD';
        amount = action === 'CALL' ? `Call $${call.toFixed(2)}` : '';
        reasoning = [
          `<strong>One Pair</strong> at ${callPct}% pot odds is ${action === 'CALL' ? 'just in range' : 'too expensive'}.`,
          `RDR2 AI over-bets top pair. ${action === 'FOLD' ? 'A fold saves chips for better spots.' : 'A call is ok here â€” but fold to further aggression.'}`
        ];
      }
    }
  } else {
    // High card
    if (call === 0 && hasDraw) {
      action = 'CHECK';
      amount = '';
      reasoning = [
        `<strong>High Card</strong> with ${draws.join(' & ')} â€” check to see a free card.`,
        `RDR2 AI checks back a lot in multi-way pots, giving you a free shot at your draw.`
      ];
    } else if (call === 0 && posScore >= 4 && numPlayers <= 3) {
      action = 'RAISE';
      amount = `Bluff bet ~$${(pot*0.5).toFixed(2)}`;
      reasoning = [
        `<strong>High Card</strong> in late position heads-up/3-handed can support a bluff. RDR2 AI folds to bets they can\'t beat.`,
        `âš ï¸ This is a bluff â€” abandon ship if you face resistance.`
      ];
    } else {
      action = call > 0 ? 'FOLD' : 'CHECK';
      amount = '';
      reasoning = [
        `<strong>High Card</strong> has little showdown value. ${call > 0 ? 'Fold and wait for a better spot.' : 'Check and hope to improve.'}`,
        call > 0 ? 'RDR2 AI doesn\'t bluff enough to make this call profitable.' : ''
      ].filter(Boolean);
    }
  }

  return {
    action,
    amount,
    reasoning,
    strength: Math.min(100, Math.max(0, strength)),
    draws,
    handName
  };
}

// â”€â”€ GET ADVICE (main entry) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function getAdvice() {
  const street     = document.getElementById('street').value;
  const position   = document.getElementById('position').value;
  const numPlayers = parseInt(document.getElementById('numPlayers').value);
  const pot        = parseFloat(document.getElementById('potSize').value) || 0;
  const call       = parseFloat(document.getElementById('callAmount').value) || 0;
  const hole       = state.holeCards;
  const community  = state.communityCards;

  // Validate
  if (!hole[0] || !hole[1]) {
    showAdvice({ action:'WAIT', amount:'', reasoning:['<strong>Please select both hole cards</strong> before requesting advice.'], strength:0, draws:[] });
    return;
  }

  const advice = getRDR2Advice({ street, position, numPlayers, pot, call, hole, community });

  // Eval hand name for log
  const handResult = evaluateHand(hole, community);
  const handName   = street === 'preflop' ? preflopHandRank(hole).desc : handResult.name;

  showAdvice(advice);
  addLog(street, advice.action, handName, pot, call, advice.amount);

  // Update pot display
  document.getElementById('statPot').textContent = `$${pot.toFixed(2)}`;
  document.getElementById('statOdds').textContent = call > 0 ? `${calcPotOdds(pot,call)}%` : 'â€”';
  document.getElementById('statStr').textContent  = handResult.name || 'â€”';
}

function showAdvice(advice) {
  const badge = document.getElementById('actionBadge');
  badge.textContent = advice.action;
  badge.className   = `action-badge ${advice.action}`;

  document.getElementById('adviceAmount').textContent = advice.amount || '';

  const draws = advice.draws && advice.draws.length > 0
    ? `<p>ðŸŽ¯ <strong>Draws detected:</strong> ${advice.draws.join(', ')}</p>` : '';

  document.getElementById('adviceReasoning').innerHTML =
    advice.reasoning.map(r => `<p>${r}</p>`).join('') + draws;

  const bar = document.getElementById('strengthBar');
  bar.style.width = advice.strength + '%';
  bar.style.background = advice.strength > 65
    ? 'linear-gradient(90deg, #4ade80, #22c55e)'
    : advice.strength > 35
    ? 'linear-gradient(90deg, #fbbf24, #f59e0b)'
    : 'linear-gradient(90deg, #f87171, #ef4444)';

  document.getElementById('strengthLabel').textContent =
    advice.strength > 65 ? 'Strong Hand' : advice.strength > 35 ? 'Moderate Hand' : 'Weak Hand';
}

function addLog(street, action, handName, pot, call, amount) {
  const entry = { street, action, handName, pot, call, amount };
  state.handLog.push(entry);

  const container = document.getElementById('logEntries');
  if (container.querySelector('.log-empty')) container.innerHTML = '';

  const div = document.createElement('div');
  div.className = 'log-entry';
  div.innerHTML = `
    <span class="log-street">${street}</span>
    <span class="log-action-text">${action}${amount ? ' â€” ' + amount : ''} (${handName}, pot $${pot.toFixed(2)}${call > 0 ? `, call $${call.toFixed(2)}` : ''})</span>
  `;
  container.appendChild(div);
  container.scrollTop = container.scrollHeight;
}

// â”€â”€ RESET â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function resetHand() {
  state.holeCards = [null, null];
  state.communityCards = [null, null, null, null, null];
  state.handLog = [];

  // Reset hole card displays
  ['holeCard1Display','holeCard2Display'].forEach((id, i) => {
    const el = document.getElementById(id);
    el.className = 'card-display empty';
    el.innerHTML = '+';
    el.onclick = () => openPicker(i === 0 ? 'hole1' : 'hole2');
  });

  // Reset community cards
  const labels = ['Flop 1','Flop 2','Flop 3','Turn','River'];
  for (let i = 0; i < 5; i++) {
    const el = document.getElementById(`cc${i}`);
    el.className = 'community-card empty';
    el.innerHTML = `+<div class="card-label">${labels[i]}</div>`;
  }

  // Reset inputs
  document.getElementById('potSize').value   = '';
  document.getElementById('callAmount').value = '0';
  document.getElementById('street').value    = 'preflop';
  onStreetChange();

  // Reset advisor
  document.getElementById('actionBadge').textContent = 'Enter your hand';
  document.getElementById('actionBadge').className   = 'action-badge WAIT';
  document.getElementById('adviceAmount').textContent = '';
  document.getElementById('adviceReasoning').innerHTML =
    '<p>Fill in your hand details on the left and press <strong>Get Advice</strong> to receive frontier wisdom.</p><p>The advisor accounts for <strong>RDR2\'s AI tendencies</strong>: loose calls, passive play, rare bluffs, and a love of top pair.</p>';
  document.getElementById('strengthBar').style.width = '0%';
  document.getElementById('strengthLabel').textContent = 'Hand Strength';
  document.getElementById('statPot').textContent  = 'â€”';
  document.getElementById('statOdds').textContent = 'â€”';
  document.getElementById('statStr').textContent  = 'â€”';
  document.getElementById('logEntries').innerHTML = '<div class="log-empty">No actions yet this hand.</div>';
}

// â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
onStreetChange();
</script>
</body>
</html>
